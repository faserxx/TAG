# Fail2ban filter for nginx authentication failures
# Matches 401 and 403 HTTP status codes in nginx access logs

[Definition]

# Detect failed authentication attempts (401 Unauthorized)
# Detect forbidden access attempts (403 Forbidden)
failregex = ^<HOST> .* "(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS) .* HTTP/.*" (401|403) .*$

# Ignore successful requests
ignoreregex = ^<HOST> .* "(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS) .* HTTP/.*" (200|201|204|301|302|304) .*$

# Date format for nginx logs
datepattern = %%d/%%b/%%Y:%%H:%%M:%%S %%z
