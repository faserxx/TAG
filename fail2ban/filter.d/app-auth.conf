# Fail2ban filter for application authentication failures
# Matches failed login attempts to /api/auth/login endpoint

[Definition]

# Detect failed authentication attempts to the login endpoint
# Looking for POST requests to /api/auth/login that return 401
failregex = ^<HOST> .* "POST /api/auth/login HTTP/.*" 401 .*$

# Ignore successful logins
ignoreregex = ^<HOST> .* "POST /api/auth/login HTTP/.*" 200 .*$

# Date format for nginx logs
datepattern = %%d/%%b/%%Y:%%H:%%M:%%S %%z
