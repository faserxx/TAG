# OWASP CRS Setup Configuration for Terminal Adventure Game

# Paranoia Level
# Level 1: Basic protection (recommended for production start)
# Level 2: Moderate protection
# Level 3: High protection
# Level 4: Maximum protection (may cause false positives)
SecAction \
  "id:900000,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.paranoia_level=1"

# Executing Paranoia Level
SecAction \
  "id:900001,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.executing_paranoia_level=1"

# Anomaly Scoring Thresholds
# Inbound: Total score for blocking requests (default: 5)
# Outbound: Total score for blocking responses (default: 4)
SecAction \
  "id:900110,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.inbound_anomaly_score_threshold=5,\
  setvar:tx.outbound_anomaly_score_threshold=4"

# HTTP Policy Settings
# Allowed HTTP methods
SecAction \
  "id:900200,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.allowed_methods=GET HEAD POST OPTIONS PUT DELETE'"

# Content-Type header validation
SecAction \
  "id:900220,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.allowed_request_content_type=|application/x-www-form-urlencoded| |multipart/form-data| |multipart/related| |text/xml| |application/xml| |application/json|'"

# Allowed HTTP versions
SecAction \
  "id:900230,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.allowed_http_versions=HTTP/1.0 HTTP/1.1 HTTP/2 HTTP/2.0'"

# File upload restrictions
SecAction \
  "id:900240,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .backup/ .bak/ .bat/ .cfg/ .cmd/ .com/ .config/ .dll/ .exe/ .ini/ .log/ .mdb/ .old/ .pass/ .pwd/ .sql/ .vbs/'"

# HTTP header restrictions
SecAction \
  "id:900250,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:'tx.restricted_headers=/proxy/ /lock-token/ /content-range/ /if/'"

# Application Specific Settings
# Block suspicious user agents
SecAction \
  "id:900300,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.block_suspicious_user_agents=1"

# Block known bad bots
SecAction \
  "id:900310,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.block_bad_bots=1"

# Sampling percentage for logging (100 = log all)
SecAction \
  "id:900400,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.sampling_percentage=100"

# Project Honeypot HTTP Blacklist
SecAction \
  "id:900500,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.block_search_ip=0"

# GeoIP Database
SecAction \
  "id:900600,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.do_geoip_lookup=0"

# Collection timeout (in seconds)
SecCollectionTimeout 600

# Initialize collections
SecAction \
  "id:900700,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.anomaly_score=0,\
  setvar:tx.sql_injection_score=0,\
  setvar:tx.xss_score=0,\
  setvar:tx.rfi_score=0,\
  setvar:tx.lfi_score=0,\
  setvar:tx.rce_score=0,\
  setvar:tx.php_injection_score=0,\
  setvar:tx.http_violation_score=0,\
  setvar:tx.session_fixation_score=0"
